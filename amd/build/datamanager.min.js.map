{"version":3,"file":"datamanager.min.js","sources":["../src/datamanager.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\nimport {getDraftItemId, getContextId} from 'tiny_ai/utils';\n\n/**\n * Tiny AI data manager.\n *\n * @module      tiny_ai/datamanager\n * @copyright   2024, ISB Bayern\n * @author      Philipp Memmel\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nconst DataManager = new _DataManager();\n\nclass _DataManager {\n\n    constructor() {\n        this.eventEmitterElement = document.createElement('div');\n    }\n\n    currentTool = null;\n    currentAiResult = null;\n    prompt = null;\n    options = null;\n\n    getDefaultOptions() {\n        const defaultOptions = {\n            itemid: getDraftItemId(),\n            contextid: getContextId()\n        }\n        if (['tts', 'audiogen'].includes(this.getCurrentTool())) {\n            defaultOptions.filename = 'audio_' + Math.random().toString(16).slice(2) + '.mp3';\n        } else if (this.getCurrentTool() === 'imggen') {\n            defaultOptions.filename = 'img_' + Math.random().toString(16).slice(2) + '.png';\n        }\n        return defaultOptions;\n    };\n\n    setCurrentTool(currentTool) {\n        this.currentTool = currentTool;\n    }\n\n    getCurrentTool() {\n        return this.currentTool;\n    }\n\n    setCurrentPrompt(prompt) {\n        this.prompt = prompt;\n        const promptUpdatedEvent = new CustomEvent('promptUpdated', {\n            detail: {\n                newPrompt: prompt\n            }\n        });\n        this.eventEmitterElement.dispatchEvent(promptUpdatedEvent);\n    }\n\n    getCurrentPrompt() {\n        return this.prompt;\n\n    }\n\n    getSelection() {\n        return this.selection;\n    }\n\n    getSelectionText() {\n        const span = document.createElement('span');\n        span.innerHTML = this.selection;\n        return span.textContent;\n    }\n\n    setSelection(selection) {\n        this.selection = selection;\n    }\n\n    getEventEmitterElement() {\n        return this.eventEmitterElement;\n    }\n\n    setCurrentAiResult(aiResult) {\n        this.currentAiResult = aiResult;\n    }\n\n    getCurrentAiResult() {\n        return this.currentAiResult;\n    }\n\n    setCurrentOptions(options) {\n        this.options = options;\n    }\n\n    getCurrentOptions() {\n        const optionsToReturn = this.options === null ? {} : this.options;\n        console.log(this.options)\n        Object.assign(optionsToReturn, this.getDefaultOptions());\n        console.log(optionsToReturn)\n        return optionsToReturn;\n    }\n}\n\nexport default DataManager;\n\n\n\n"],"names":["DataManager","constructor","eventEmitterElement","document","createElement","getDefaultOptions","defaultOptions","itemid","contextid","includes","this","getCurrentTool","filename","Math","random","toString","slice","setCurrentTool","currentTool","setCurrentPrompt","prompt","promptUpdatedEvent","CustomEvent","detail","newPrompt","dispatchEvent","getCurrentPrompt","getSelection","selection","getSelectionText","span","innerHTML","textContent","setSelection","getEventEmitterElement","setCurrentAiResult","aiResult","currentAiResult","getCurrentAiResult","setCurrentOptions","options","getCurrentOptions","optionsToReturn","console","log","Object","assign"],"mappings":";;;;;;;;2FA0BMA,YAAc,UAIhBC,iDAIc,6CACI,oCACT,qCACC,WANDC,oBAAsBC,SAASC,cAAc,OAQtDC,0BACUC,eAAiB,CACnBC,QAAQ,2BACRC,WAAW,gCAEX,CAAC,MAAO,YAAYC,SAASC,KAAKC,kBAClCL,eAAeM,SAAW,SAAWC,KAAKC,SAASC,SAAS,IAAIC,MAAM,GAAK,OAC1C,WAA1BN,KAAKC,mBACZL,eAAeM,SAAW,OAASC,KAAKC,SAASC,SAAS,IAAIC,MAAM,GAAK,QAEtEV,eAGXW,eAAeC,kBACNA,YAAcA,YAGvBP,wBACWD,KAAKQ,YAGhBC,iBAAiBC,aACRA,OAASA,aACRC,mBAAqB,IAAIC,YAAY,gBAAiB,CACxDC,OAAQ,CACJC,UAAWJ,eAGdlB,oBAAoBuB,cAAcJ,oBAG3CK,0BACWhB,KAAKU,OAIhBO,sBACWjB,KAAKkB,UAGhBC,yBACUC,KAAO3B,SAASC,cAAc,eACpC0B,KAAKC,UAAYrB,KAAKkB,UACfE,KAAKE,YAGhBC,aAAaL,gBACJA,UAAYA,UAGrBM,gCACWxB,KAAKR,oBAGhBiC,mBAAmBC,eACVC,gBAAkBD,SAG3BE,4BACW5B,KAAK2B,gBAGhBE,kBAAkBC,cACTA,QAAUA,QAGnBC,0BACUC,gBAAmC,OAAjBhC,KAAK8B,QAAmB,GAAK9B,KAAK8B,eAC1DG,QAAQC,IAAIlC,KAAK8B,SACjBK,OAAOC,OAAOJ,gBAAiBhC,KAAKL,qBACpCsC,QAAQC,IAAIF,iBACLA,+BAIA1C"}