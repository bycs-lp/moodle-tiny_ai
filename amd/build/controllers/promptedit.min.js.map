{"version":3,"file":"promptedit.min.js","sources":["../../src/controllers/promptedit.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Controller for handling the show/hide prompt button and the associated textarea.\n *\n * @module      tiny_ai/controllers/promtedit_controller\n * @copyright   2024, ISB Bayern\n * @author      Philipp Memmel\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {prefetchStrings} from 'core/prefetch';\nimport {getStrings} from 'core/str';\nimport DataManager from 'tiny_ai/datamanager';\nimport SELECTORS from 'tiny_ai/selectors';\n\nexport default class {\n\n    constructor(baseSelector) {\n        this.baseElement = document.querySelector(baseSelector);\n    }\n\n    async init() {\n        const showPromptButton = this.baseElement.querySelector('[data-action=\"showprompt\"]');\n        const textarea = this.baseElement.querySelector('textarea[data-type=\"prompt\"]');\n\n        textarea.innerHTML = DataManager.getCurrentPrompt();\n        DataManager.getEventEmitterElement().addEventListener('promptUpdated', (event) => {\n            textarea.value = event.detail.newPrompt;\n        });\n        textarea.addEventListener('keyup', event => {\n            console.log(textarea.value)\n            DataManager.setCurrentPrompt(textarea.value);\n            console.log(DataManager.getCurrentPrompt())\n\n        });\n\n        if (showPromptButton) {\n            const [showPromptString, hidePromptString] = await getStrings(\n                [\n                    {key: 'showprompt', component: 'tiny_ai'},\n                    {key: 'hideprompt', component: 'tiny_ai'}\n                ]\n            );\n            showPromptButton.addEventListener('click', (event) => {\n                const currentText = showPromptButton.querySelector('[data-text]').innerText;\n                showPromptButton.querySelector('[data-text]').innerText = currentText === showPromptString ? hidePromptString : showPromptString;\n                const buttonIcon = showPromptButton.querySelector('i');\n                if (buttonIcon.classList.contains('fa-eye')) {\n                    buttonIcon.classList.remove('fa-eye');\n                    buttonIcon.classList.add('fa-eye-slash');\n                } else {\n                    buttonIcon.classList.remove('fa-eye-slash');\n                    buttonIcon.classList.add('fa-eye');\n                }\n                textarea.classList.toggle('d-none');\n            });\n        }\n    }\n}\n"],"names":["constructor","baseSelector","baseElement","document","querySelector","showPromptButton","this","textarea","innerHTML","DataManager","getCurrentPrompt","getEventEmitterElement","addEventListener","event","value","detail","newPrompt","console","log","setCurrentPrompt","showPromptString","hidePromptString","key","component","currentText","innerText","buttonIcon","classList","contains","remove","add","toggle"],"mappings":";;;;;;;;mNA+BIA,YAAYC,mBACHC,YAAcC,SAASC,cAAcH,iCAIpCI,iBAAmBC,KAAKJ,YAAYE,cAAc,8BAClDG,SAAWD,KAAKJ,YAAYE,cAAc,mCAEhDG,SAASC,UAAYC,qBAAYC,wCACrBC,yBAAyBC,iBAAiB,iBAAkBC,QACpEN,SAASO,MAAQD,MAAME,OAAOC,aAElCT,SAASK,iBAAiB,SAASC,QAC/BI,QAAQC,IAAIX,SAASO,4BACTK,iBAAiBZ,SAASO,OACtCG,QAAQC,IAAIT,qBAAYC,uBAIxBL,iBAAkB,OACXe,iBAAkBC,wBAA0B,mBAC/C,CACI,CAACC,IAAK,aAAcC,UAAW,WAC/B,CAACD,IAAK,aAAcC,UAAW,aAGvClB,iBAAiBO,iBAAiB,SAAUC,cAClCW,YAAcnB,iBAAiBD,cAAc,eAAeqB,UAClEpB,iBAAiBD,cAAc,eAAeqB,UAAYD,cAAgBJ,iBAAmBC,iBAAmBD,uBAC1GM,WAAarB,iBAAiBD,cAAc,KAC9CsB,WAAWC,UAAUC,SAAS,WAC9BF,WAAWC,UAAUE,OAAO,UAC5BH,WAAWC,UAAUG,IAAI,kBAEzBJ,WAAWC,UAAUE,OAAO,gBAC5BH,WAAWC,UAAUG,IAAI,WAE7BvB,SAASoB,UAAUI,OAAO"}