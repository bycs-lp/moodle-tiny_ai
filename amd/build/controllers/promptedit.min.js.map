{"version":3,"file":"promptedit.min.js","sources":["../../src/controllers/promptedit.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Controller for handling the show/hide prompt button and the associated textarea.\n *\n * @module      tiny_ai/controllers/promtedit_controller\n * @copyright   2024, ISB Bayern\n * @author      Philipp Memmel\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {getStrings} from 'core/str';\nimport {getDatamanager, getCurrentModalUniqId} from 'tiny_ai/utils';\n\nexport default class {\n\n    constructor(baseSelector) {\n        this.baseElement = document.querySelector(baseSelector);\n    }\n\n    async init() {\n        const showPromptButton = this.baseElement.querySelector('[data-action=\"showprompt\"]');\n        const textarea = this.baseElement.querySelector('textarea[data-type=\"prompt\"]');\n\n        const datamanager = getDatamanager(getCurrentModalUniqId(this.baseElement));\n        textarea.innerHTML = datamanager.getCurrentPrompt();\n        datamanager.getEventEmitterElement().addEventListener('promptUpdated', (event) => {\n            textarea.value = event.detail.newPrompt;\n        });\n        textarea.addEventListener('input', () => {\n            datamanager.setCurrentPrompt(textarea.value);\n        });\n\n        if (showPromptButton) {\n            const [showPromptString, hidePromptString] = await getStrings(\n                [\n                    {key: 'showprompt', component: 'tiny_ai'},\n                    {key: 'hideprompt', component: 'tiny_ai'}\n                ]\n            );\n            showPromptButton.addEventListener('click', () => {\n                const currentText = showPromptButton.querySelector('[data-text]').innerText;\n                showPromptButton.querySelector('[data-text]').innerText =\n                    currentText === showPromptString ? hidePromptString : showPromptString;\n                const buttonIcon = showPromptButton.querySelector('i');\n                if (buttonIcon.classList.contains('fa-eye')) {\n                    buttonIcon.classList.remove('fa-eye');\n                    buttonIcon.classList.add('fa-eye-slash');\n                } else {\n                    buttonIcon.classList.remove('fa-eye-slash');\n                    buttonIcon.classList.add('fa-eye');\n                }\n                textarea.classList.toggle('d-none');\n            });\n        }\n    }\n}\n"],"names":["constructor","baseSelector","baseElement","document","querySelector","showPromptButton","this","textarea","datamanager","innerHTML","getCurrentPrompt","getEventEmitterElement","addEventListener","event","value","detail","newPrompt","setCurrentPrompt","showPromptString","hidePromptString","key","component","currentText","innerText","buttonIcon","classList","contains","remove","add","toggle"],"mappings":";;;;;;;;;MA6BIA,YAAYC,mBACHC,YAAcC,SAASC,cAAcH,iCAIpCI,iBAAmBC,KAAKJ,YAAYE,cAAc,8BAClDG,SAAWD,KAAKJ,YAAYE,cAAc,gCAE1CI,aAAc,0BAAe,gCAAsBF,KAAKJ,iBAC9DK,SAASE,UAAYD,YAAYE,mBACjCF,YAAYG,yBAAyBC,iBAAiB,iBAAkBC,QACpEN,SAASO,MAAQD,MAAME,OAAOC,aAElCT,SAASK,iBAAiB,SAAS,KAC/BJ,YAAYS,iBAAiBV,SAASO,UAGtCT,iBAAkB,OACXa,iBAAkBC,wBAA0B,mBAC/C,CACI,CAACC,IAAK,aAAcC,UAAW,WAC/B,CAACD,IAAK,aAAcC,UAAW,aAGvChB,iBAAiBO,iBAAiB,SAAS,WACjCU,YAAcjB,iBAAiBD,cAAc,eAAemB,UAClElB,iBAAiBD,cAAc,eAAemB,UAC1CD,cAAgBJ,iBAAmBC,iBAAmBD,uBACpDM,WAAanB,iBAAiBD,cAAc,KAC9CoB,WAAWC,UAAUC,SAAS,WAC9BF,WAAWC,UAAUE,OAAO,UAC5BH,WAAWC,UAAUG,IAAI,kBAEzBJ,WAAWC,UAAUE,OAAO,gBAC5BH,WAAWC,UAAUG,IAAI,WAE7BrB,SAASkB,UAAUI,OAAO"}